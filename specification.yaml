openapi: "3.0.2"
info:
  title: "P2P地震情報 API仕様書"
  version: "0.1.0"
servers:
  - url: https://api.p2pquake.net/v2
paths:
  /jma/quake:
    get:
      tags:
        - 気象庁 地震情報・津波予報 JSON API
      summary: 地震情報リスト
      description: |
        地震情報を返却します。デフォルトは新しい順に最大10件です。
        データは2015年1月10日から提供しています。
      responses:
        200:
          description: 地震情報リスト
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JMAQuakes'
        400:
          description: パラメタに誤りがあります
    parameters:
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/order'
      - $ref: '#/components/parameters/sinceDate'
      - $ref: '#/components/parameters/untilDate'
      - $ref: '#/components/parameters/quakeType'
      - $ref: '#/components/parameters/minMagnitude'
      - $ref: '#/components/parameters/maxMagnitude'
      - $ref: '#/components/parameters/minScale'
      - $ref: '#/components/parameters/maxScale'
      - $ref: '#/components/parameters/prefecture'
  /jma/quake/{id}:
    get:
      tags:
        - 気象庁 地震情報・津波予報 JSON API
      summary: 地震情報
      responses:
        200:
          description: 指定したIDの地震情報を返却します。
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JMAQuake'
        400:
          description: IDの形式が間違っています
        404:
          description: 指定IDの情報が見つかりません
    parameters:
      - $ref: '#/components/parameters/id'
  /jma/tsunami:
    get:
      tags:
        - 気象庁 地震情報・津波予報 JSON API
      summary: 津波予報リスト
      description: |
        津波予報を返却します。デフォルトは新しい順に最大10件です。
        データは2016年11月22日から提供しています。
      responses:
        200:
          description: 津波予報リスト
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JMATsunamis'
        400:
          description: パラメタに誤りがあります
    parameters:
      - $ref: '#/components/parameters/limit'
      - $ref: '#/components/parameters/offset'
      - $ref: '#/components/parameters/order'
      - $ref: '#/components/parameters/sinceDate'
      - $ref: '#/components/parameters/untilDate'
  /jma/tsunami/{id}:
    get:
      tags:
        - 気象庁 地震情報・津波予報 JSON API
      summary: 津波予報
      responses:
        200:
          description: 指定したIDの津波予報を返却します。
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JMATsunami'
        400:
          description: IDの形式が間違っています
        404:
          description: 指定IDの情報が見つかりません
    parameters:
      - $ref: '#/components/parameters/id'
  /history:
    get:
      tags:
        - (未実装)
      summary: P2P地震情報 JSON API (v2)
      description: 未実装です。[JSON API v1](https://www.p2pquake.net/dev/json-api/) をご利用ください。
      responses:
        200:
          description: TODO
  /ws:
    get:
      tags:
        - (未実装)
      summary: P2P地震情報 リアルタイムAPI
      description: 未実装です。
      responses:
        default:
          description: TODO
components:
  parameters:
    offset:
      name: offset
      in: query
      required: false
      description: 読み飛ばす件数 (デフォルトは0)。例えば、 limit=100&offset=200 とすると、201件目から100件を返却します。
      schema:
        type: string
    limit:
      name: limit
      in: query
      required: false
      description: 返却件数（デフォルトは10）
      schema:
        type: integer
        format: int32
        minimum: 1
        maximum: 100
    quakeType:
      name: types[]
      in: query
      required: false
      description: 地震情報の種類
      schema:
        type: array
        items:
          type: string
          enum: 
            - ScalePrompt(震度速報)
            - Destination(震源に関する情報)
            - ScaleAndDestination(震度・震源に関する情報)
            - DetailScale(各地の震度に関する情報)
            - Foreign(遠地地震に関する情報)
            - Other(その他の情報)
    minScale:
      name: min_scale
      in: query
      required: false
      description: 最大震度の下限
      schema:
        type: integer
        format: int32
        enum:
          - 10(震度1)
          - 20(震度2)
          - 30(震度3)
          - 40(震度4)
          - 45(震度5弱)
          - 50(震度5強)
          - 55(震度6弱)
          - 60(震度6強)
          - 70(震度7)
    maxScale:
      name: max_scale
      in: query
      required: false
      description: 最大震度の上限
      schema:
        type: integer
        format: int32
        enum:
          - 10(震度1)
          - 20(震度2)
          - 30(震度3)
          - 40(震度4)
          - 45(震度5弱)
          - 50(震度5強)
          - 55(震度6弱)
          - 60(震度6強)
          - 70(震度7)
    prefecture:
      name: prefectures[]
      in: query
      required: false
      description: 各都道府県の最低震度
      schema:
        type: array
        items:
          type: object
    minMagnitude:
      name: min_magnitude
      in: query
      required: false
      description: マグニチュード下限
      schema:
        type: number
    maxMagnitude:
      name: max_magnitude
      in: query
      required: false
      description: マグニチュード上限
      schema:
        type: number
    sinceDate:
      name: since_date
      in: query
      required: false
      description: 指定日かそれ以降 (yyyyMMdd形式)
      schema:
        type: string
    untilDate:
      name: until_date
      in: query
      required: false
      description: 指定日かそれ以前 (yyyyMMdd形式)
      schema:
        type: string
    order:
      name: order
      in: query
      description: 並び順
      schema:
        type: integer
        format: int32
        enum:
          - 1 (昇順、古い順)
          - -1 (降順、新しい順)
    id:
      name: id
      in: query
      description: ID
      schema:
        type: string
  schemas:
    JMAQuake:
      type: object
      required:
        - issue
        - earthquake
      properties:
        issue:
          type: object
          description: 発表元の情報
          required:
            - type
          properties:
            source:
              type: string
              description: 発表元
            time:
              type: string
              description: 発表日時
            type:
              type: string
              description: 発表種類
              enum:
                - ScalePrompt(震度速報)
                - Destination(震源に関する情報)
                - ScaleAndDestination(震度・震源に関する情報)
                - DetailScale(各地の震度に関する情報)
                - Foreign(遠地地震に関する情報)
                - Other(その他の情報)
            correct:
              type: boolean
              description: 震度訂正かどうか
        earthquake:
          type: object
          required:
            - time
          properties:
            time:
              type: string
              description: 発生日時
            hypocenter:
              type: object
              description: 震源情報
              properties:
                name:
                  type: string
                  description: 名称
                latitude:
                  type: number
                  description: 緯度。震源情報が存在しない場合は-200となります。
                longitude:
                  type: number
                  description: 経度。震源情報が存在しない場合は-200となります。
                depth:
                  type: integer
                  format: int32
                  description: 深さ(km)。「ごく浅い」は0、震源情報が存在しない場合は-1となります。
                magnitude:
                  type: number
                  description: マグニチュード。震源情報が存在しない場合は-1となります。
            maxScale:
              type: integer
              format: int32
              description: 最大震度。震度情報が存在しない場合は-1となります。
              enum:
                - -1(震度情報なし)
                - 10(震度1)
                - 20(震度2)
                - 30(震度3)
                - 40(震度4)
                - 45(震度5弱)
                - 50(震度5強)
                - 55(震度6弱)
                - 60(震度6強)
                - 70(震度7)
            domesticTsunami:
              type: string
              description: 国内への津波の有無
              enum:
                - None(なし)
                - Unknown(不明)
                - Checking(調査中)
                - NonEffective(若干の海面変動が予想されるが、被害の心配なし)
                - Watch(津波注意報)
                - Warning(津波予報(種類不明))
            foreignTsunami:
              type: string
              description: 海外での津波の有無
              enum:
                - None(なし)
                - Unknown(不明)
                - Checking(調査中)
                - NonEffectiveNearby(震源の近傍で小さな津波の可能性があるが、被害の心配なし)
                - WarningNearby(震源の近傍で津波の可能性がある)
                - WarningPacific(太平洋で津波の可能性がある)
                - WarningPacificWide(太平洋の広域で津波の可能性がある)
                - WarningIndian(インド洋で津波の可能性がある)
                - WarningIndianWide(インド洋の広域で津波の可能性がある)
                - Potential(一般にこの規模では津波の可能性がある)
        points:
          type: array
          description: 震度観測点の情報
          items:
            type: object
            required:
              - pref
              - addr
              - isArea
              - scale
            properties:
              pref:
                type: string
                description: 都道府県
              addr:
                type: string
                description: 震度観測点名称（震度速報の場合は [気象庁 | 緊急地震速報や震度情報で用いる区域の名称](http://www.data.jma.go.jp/svd/eqev/data/joho/shindo-name.html) に記載のある区域名）
              isArea:
                type: boolean
                description: 区域名かどうか
              scale:
                type: number
                description: 震度
                enum:
                  - 10(震度1)
                  - 20(震度2)
                  - 30(震度3)
                  - 40(震度4)
                  - 45(震度5弱)
                  - 46(震度5弱以上と推定されるが震度情報を入手していない)
                  - 50(震度5強)
                  - 55(震度6弱)
                  - 60(震度6強)
                  - 70(震度7)
    JMAQuakes:
      type: array
      items:
        $ref: '#/components/schemas/JMAQuake'
    JMATsunami:
      type: object
      required:
        - code
        - cancelled
        - issue
      properties:
        code:
          type: integer
          format: int32
          description: 情報コード。常に552です。
        cancelled:
          type: boolean
          description: 津波予報が解除されたかどうか。trueの場合、areasは空配列です。
        issue:
          type: object
          description: 発表元の情報
          required:
            - source
            - time
            - type
          properties:
            source:
              type: string
              description: 発表元
            time:
              type: string
              description: 発表日時
            type:
              type: string
              description: 発表種類。現在は Focus (津波予報) のみです。
        areas:
          type: array
          description: 津波予報の詳細
          items:
            type: object
            properties:
              grade:
                type: string
                description: 津波予報の種類
                enum:
                  - MajorWarning (大津波警報)
                  - Warning (津波警報)
                  - Watch (津波注意報)
                  - Unknown (不明)
              immediate:
                type: boolean
                description: 直ちに津波が来襲すると予想されているかどうか
              name:
                type: string
                description: 津波予報区名。[気象庁｜津波予報区について](http://www.data.jma.go.jp/svd/eqev/data/joho/t-yohokuinfo.html)を参照。
      example:
        code: 551
        cancelled: false
        issue:
          source: 気象庁
          time: "2019/06/18 22:24:00"
          type: "Focus"
        areas:
          - grade: Warning
            immediate: true
            name: 福島県
          - grade: Watch
            immediate: false
            name: 青森県太平洋沿岸
    JMATsunamis:
      type: array
      items:
        $ref: '#/components/schemas/JMATsunami'
